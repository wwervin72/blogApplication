define([],function(){function t(t){this.dom=t,this.nodes=[],this.lines=[],this.mousePos=[0,0];var i={width:this.dom.getBoundingClientRect().width,height:this.dom.getBoundingClientRect().height,backgroundColor:"#000",easingFactor:5,nodeCount:100,nodeColor:"#aaa",lineColor:"#fff"};return this.option=o(i,this.getCustomSetting()),this.draw(),this}function o(){var t,o={},n=!0;return arguments.length?(Array.prototype.forEach.call(arguments,function e(s,h){!h&&"Boolean"===i(s)&&s&&(n=!0);for(t in s)s.hasOwnProperty(t)&&("object"===i(s[t])&&n?e(s):o[t]=s[t])}),o):o}function i(t){return Object.prototype.toString.call(t).slice(8,-1)}function n(t,o,i){return t>i?t:o<i?o:i}return t.prototype={contructor:t,getCustomSetting:function(){return JSON.parse(this.dom.getAttribute("particle-set"))||{}},createCanvas:function(){var t,o=this.dom.querySelector("canvas");return o||(o=document.createElement("canvas"),this.dom.appendChild(o)),o.width=this.option.width,o.height=this.option.height,this.canvas=o,t=o.getContext("2d"),t.fillStyle=this.option.backgroundColor,t.fillRect(0,0,this.option.width,this.option.height),t},createNodes:function(){this.nodes.length=0;for(var t=0;t<this.option.nodeCount;t++)this.nodes.push({drivenByMouse:0==t,x:Math.random()*this.option.width,y:Math.random()*this.option.height,vx:1*Math.random()-.5,vy:1*Math.random()-.5,radius:Math.random()>.9?2+1*Math.random():1+10*Math.random()});for(var o=this.nodes.length,i=0;i<o;i++)for(var n=i;n<o;n++)this.lines.push({from:this.nodes[i],to:this.nodes[n]})},step:function(){var t=this.option.width,o=this.option.height;this.nodes.forEach(function(i){i.drivenByMouse||(i.x+=i.vx,i.y+=i.vy,(i.x<=0||i.x>=t)&&(i.vx*=-1,i.x=n(0,t,i.x)),(i.y<=0||i.y>=o)&&(i.vy*=-1,i.y=n(0,o,i.y)))}),this.adjustNodeDrivenByMouse(),this.render(),window.requestAnimationFrame(this.step.bind(this))},adjustNodeDrivenByMouse:function(){this.nodes[0].x+=(this.mousePos[0]-this.nodes[0].x)/this.option.easingFactor,this.nodes[0].y+=(this.mousePos[1]-this.nodes[0].y)/this.option.easingFactor},lengthOfEdge:function(t){return Math.sqrt(Math.pow(t.from.x-t.to.x,2)+Math.pow(t.from.y-t.to.y,2))},render:function(){var t=this.ctx,o=this;t.fillStyle=o.option.backgroundColor,t.fillRect(0,0,o.option.width,o.option.height),t.globalAlpha=o.option.globalAlpha,o.lines.forEach(function(i){var n=o.lengthOfEdge(i),e=o.canvas.width/8;n>e||(t.strokeStyle=o.option.lineColor,t.lineWidth=2.5*(1-n/e),t.globalAlpha=1-n/e,t.beginPath(),t.moveTo(i.from.x,i.from.y),t.lineTo(i.to.x,i.to.y),t.stroke())}),o.nodes.forEach(function(i){i.drivenByMouse||(t.fillStyle=o.option.nodeColor,t.beginPath(),t.arc(i.x,i.y,i.radius,0,2*Math.PI),t.fill())})},draw:function(){this.ctx=this.createCanvas(),this.createNodes(),function(t){window.onmousemove=function(o){t.mousePos[0]=o.pageX,t.mousePos[1]=o.pageY}}(this),window.requestAnimationFrame(this.step.bind(this))},refresh:function(t,o){this.option.width=t,this.option.height=o,this.draw()}},window.Particle=t,window});